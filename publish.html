
<!DOCTYPE HTML>
<html lang="" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Publish Â· GoCD S3 Artifacts</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-anchors/plugin.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-search/search.css">
                
            
                
                <link rel="stylesheet" href="gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="material_poller.html" />
    
    
    <link rel="prev" href="installation.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Type to search" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    
    
        
        <li>
            <a href="http://oss.indix.com/gocd-s3-artifacts" target="_blank" class="custom-link">Home</a>
        </li>
    
        
        <li>
            <a href="https://github.com/indix/gocd-s3-artifacts" target="_blank" class="custom-link">Contribute</a>
        </li>
    
    

    
    <li class="divider"></li>
    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="./">
            
                <a href="./">
            
                    
                    Introduction
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.2" data-path="installation.html">
            
                <a href="installation.html">
            
                    
                    Installation
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="1.3" data-path="publish.html">
            
                <a href="publish.html">
            
                    
                    Publish
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.4" data-path="material_poller.html">
            
                <a href="material_poller.html">
            
                    
                    Material Poller
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="1.5" data-path="fetch.html">
            
                <a href="fetch.html">
            
                    
                    Fetch
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Published with GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="." >Publish</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="publish"><a name="publish" class="plugin-anchor" href="#publish"><i class="fa fa-link" aria-hidden="true"></i></a>Publish</h1>
<p>The <code>Publish to S3</code> task plugin (indix.s3publish) is used to upload artifacts to S3.</p>
<h2 id="environment-variables"><a name="environment-variables" class="plugin-anchor" href="#environment-variables"><i class="fa fa-link" aria-hidden="true"></i></a>Environment variables</h2>
<p>The <code>GO_SERVER_DASHBOARD_URL</code> environment variable is required for this plugin. It can be set in the pipeline, GoCD environment or in the agent.</p>
<p>Optionally, <code>GO_ARTIFACTS_S3_BUCKET</code> can be set to point at the artifacts bucket to use. This is recommended if there is only one bucket in play. If there are multiple buckets, the bucket info can be configured from the plugin as noted below.</p>
<h2 id="configuration"><a name="configuration" class="plugin-anchor" href="#configuration"><i class="fa fa-link" aria-hidden="true"></i></a>Configuration</h2>
<p>Once the plugin is installed, it should be available as a task, ready to be added into any of your jobs. From the admin section of the concerned job, click on the <code>Add new task</code> link and choose <code>Publish To S3</code> as the task.</p>
<p>The resulting dialog for the task is shown in the following screenshot:</p>
<p><img src="resources/images/modal_publish.png" alt=""></p>
<p>The interface is pretty similar to the Artifacts configuration in Go. Clicking on the <code>Add</code> link adds text boxes where source and destination paths for artifacts can be provided. This is shown in the following example screenshot:</p>
<p><img src="resources/images/modal_publish_2.png" alt=""></p>
<p>The artifacts get uploaded to the S3 path <code>s3://&lt;GO_ARTIFACTS_S3_BUCKET&gt;/&lt;PIPELINE_NAME&gt;/&lt;STAGE_NAME&gt;/&lt;JOB_NAME&gt;/&lt;PIPELINE_COUNTER&gt;.&lt;STAGE_COUNTER&gt;</code> as the root path.</p>
<p>For example, if the pipeline name is <code>TestPublish</code>, and the stage and job names are <code>defaultStage</code> and <code>defaultJob</code> respectively, the root path for the artifacts for the eighth run of the pipeline and the first run of <code>defaultStage</code> will be <code>s3://gocd/TestPublish/defaultStage/defaultJob/8.1/</code>. <code>gocd</code> here is the name of the bucket for storing artifacts.</p>
<p>As per the screenshot, the jar files in <code>fetch/target</code>, <code>material/target</code> and <code>publish/target</code> will be uploaded to the root of the artifacts path mentioned above. The <code>README.md</code> file will be uploaded under the <code>docs</code> folder.</p>
<h2 id="destination-prefix"><a name="destination-prefix" class="plugin-anchor" href="#destination-prefix"><i class="fa fa-link" aria-hidden="true"></i></a>Destination prefix</h2>
<p>The default mode of publish is to push artifacts to the prefix based on pipeline information as mentioned above. The <code>Destination Prefix</code> setting can be used to push artifacts to a specific custom prefix.</p>
<p>Note:When the destination prefix is used, the uploaded artifacts cannot be used with the material and fetch plugins. This case is for simple push of artifacts to S3.</p>
<h2 id="artifacts-bucket"><a name="artifacts-bucket" class="plugin-anchor" href="#artifacts-bucket"><i class="fa fa-link" aria-hidden="true"></i></a>Artifacts Bucket</h2>
<p>The artifacts bucket to push to can be configured if either <code>GO_ARTIFACTS_S3_BUCKET</code> is not set or if there is a need to push to multiple artifacts buckets in the same pipeline / GoCD server. If this is configured, this is used in preference to the value in <code>GO_ARTIFACTS_S3_BUCKET</code>.</p>
<p>After configuring the plugin, click on <code>Save</code> to add the task to the job.</p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="installation.html" class="navigation navigation-prev " aria-label="Previous page: Installation">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="material_poller.html" class="navigation navigation-next " aria-label="Next page: Material Poller">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Publish","level":"1.3","depth":1,"next":{"title":"Material Poller","level":"1.4","depth":1,"path":"material_poller.md","ref":"material_poller.md","articles":[]},"previous":{"title":"Installation","level":"1.2","depth":1,"path":"installation.md","ref":"installation.md","articles":[]},"dir":"ltr"},"config":{"plugins":["-highlight","anchors","ga"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"ga":{"configuration":"auto","token":"UA-59836563-1"},"anchors":{},"search":{},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"sharing":{"facebook":true,"twitter":true,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["facebook","google","twitter","weibo","instapaper"]},"fontsettings":{"theme":"white","family":"sans","size":2},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":false}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{},"title":"GoCD S3 Artifacts","links":{"sidebar":{"Home":"http://oss.indix.com/gocd-s3-artifacts","Contribute":"https://github.com/indix/gocd-s3-artifacts"},"sharing":{"google":"http://oss.indix.com/gocd-s3-artifacts","facebook":"http://oss.indix.com/gocd-s3-artifacts","twitter":"http://oss.indix.com/gocd-s3-artifacts","all":"http://oss.indix.com/gocd-s3-artifacts"}},"gitbook":"*","description":"Documentation for the GoCD S3 artifacts plugins"},"file":{"path":"publish.md","mtime":"2017-09-18T09:41:04.017Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2017-09-18T09:43:55.158Z"},"basePath":".","book":{"language":""}});
        });
    </script>
</div>

        
    <script src="gitbook/gitbook.js"></script>
    <script src="gitbook/theme.js"></script>
    
        
        <script src="gitbook/gitbook-plugin-ga/plugin.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search-engine.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-search/search.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

